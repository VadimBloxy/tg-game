<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>TEXT_PARKOUR // VADIMIVASH</title>
    <style>
        body { 
            margin: 0; padding: 0; background: #f0f0f0; 
            font-family: 'Segoe UI', sans-serif; overflow: hidden; 
        }
        
        /* Твой персонаж */
        #player {
            position: absolute; width: 30px; height: 30px;
            background: #ff4757; border-radius: 5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        /* Золотой финиш */
        #exit {
            position: absolute; top: 50px; left: 50%; transform: translateX(-50%);
            padding: 20px 40px; background: gold; border: 4px solid #000;
            font-weight: bold; font-size: 24px; color: #000;
        }

        /* Платформы из текста */
        .word {
            position: absolute; background: #2f3542; color: #fff;
            padding: 10px 15px; border-radius: 4px; font-size: 18px;
            white-space: nowrap; box-shadow: 0 5px 0 #1e2124;
        }

        /* Поле ввода */
        #input-container {
            position: fixed; bottom: 0; left: 0; width: 100%;
            padding: 20px; background: #fff; border-top: 2px solid #ccc;
            display: flex; justify-content: center; z-index: 2000;
        }
        input {
            width: 400px; padding: 15px; font-size: 18px;
            border: 2px solid #2f3542; outline: none;
        }

        #ui-hint {
            position: fixed; top: 20px; left: 20px;
            background: rgba(255,255,255,0.8); padding: 10px; border-radius: 5px;
        }
    </style>
</head>
<body>

    <div id="ui-hint">
        <b>WASD / Стрелки</b> - Движение<br>
        <b>Пиши текст вниз + Enter</b> - Создать мост
    </div>

    <div id="exit">EXIT (ФИНИШ)</div>
    <div id="player"></div>

    <div class="word" style="bottom: 150px; left: 100px;">Платформа 1</div>
    <div class="word" style="bottom: 250px; right: 200px;">Прыгай выше!</div>

    <div id="input-container">
        <input type="text" id="text-input" placeholder="Напиши что-нибудь и нажми Enter...">
    </div>

<script>
    const player = {
        el: document.getElementById('player'),
        x: window.innerWidth / 2,
        y: window.innerHeight - 150,
        vx: 0, vy: 0, w: 30, h: 30,
        onGround: false
    };

    const input = document.getElementById('text-input');
    const words = [];
    const keys = {};

    // Собираем все стартовые слова
    document.querySelectorAll('.word').forEach(el => words.push(el));

    // Управление
    window.onkeydown = (e) => keys[e.code] = true;
    window.onkeyup = (e) => keys[e.code] = false;

    // Создание новых слов
    input.onkeydown = (e) => {
        if(e.code === 'Enter' && input.value.trim() !== "") {
            const newWord = document.createElement('div');
            newWord.className = 'word';
            newWord.innerText = input.value;
            // Ставим слово там, где игрок, но чуть ниже
            newWord.style.left = (player.x - 50) + 'px';
            newWord.style.top = (player.y + 100) + 'px';
            document.body.appendChild(newWord);
            words.push(newWord);
            input.value = "";
            input.blur(); // Убрать фокус, чтобы можно было бегать
        }
    };

    function loop() {
        // Движение влево/вправо
        if (keys['ArrowLeft'] || keys['KeyA']) player.vx = -7;
        else if (keys['ArrowRight'] || keys['KeyD']) player.vx = 7;
        else player.vx *= 0.8;

        // Прыжок
        if ((keys['ArrowUp'] || keys['KeyW'] || keys['Space']) && player.onGround) {
            player.vy = -18;
            player.onGround = false;
        }

        // Физика
        player.vy += 0.8; // Гравитация
        player.x += player.vx;
        player.y += player.vy;

        // Пол экрана (чтобы не падать бесконечно)
        if (player.y > window.innerHeight - 100) {
            player.y = window.innerHeight - 100;
            player.vy = 0;
            player.onGround = true;
        }

        // КРАЯ ЭКРАНА
        if (player.x < 0) player.x = 0;
        if (player.x > window.innerWidth - player.w) player.x = window.innerWidth - player.w;

        // ПРОВЕРКА СЛОВ (Коллизия)
        player.onGround = false;
        words.forEach(word => {
            const r = word.getBoundingClientRect();
            if (player.x + player.w > r.left && 
                player.x < r.right && 
                player.y + player.h > r.top && 
                player.y + player.h < r.top + 30 && // Наступаем только сверху
                player.vy >= 0) {
                player.y = r.top - player.h;
                player.vy = 0;
                player.onGround = true;
            }
        });

        // ПРОВЕРКА ФИНИША
        const exit = document.getElementById('exit').getBoundingClientRect();
        if (player.x < exit.right && player.x + player.w > exit.left &&
            player.y < exit.bottom && player.y + player.h > exit.top) {
            alert("ПОБЕДА! Ты выбрался из текста!");
            location.reload();
        }

        // Отрисовка
        player.el.style.left = player.x + 'px';
        player.el.style.top = player.y + 'px';

        requestAnimationFrame(loop);
    }

    loop();
</script>
</body>
</html>
