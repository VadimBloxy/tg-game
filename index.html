<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Pixel 2D Game</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #000;
  }
  canvas {
    display: block;
    image-rendering: pixelated; /* пиксельный стиль */
    background: #87ceeb; /* небо */
  }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

const TILE_SIZE = 32; // размер блока
const MAP_WIDTH = 20;
const MAP_HEIGHT = 15;

// карта блоков (0 = воздух, 1 = земля)
let map = [];
for(let y = 0; y < MAP_HEIGHT; y++){
    map[y] = [];
    for(let x = 0; x < MAP_WIDTH; x++){
        map[y][x] = (y > MAP_HEIGHT/2) ? 1 : 0;
    }
}

// игрок
let player = {x: 5, y: 5, color: "#ff0"};

// клавиши
let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

// игровой цикл
function gameLoop(){
    // движение игрока
    if(keys["ArrowLeft"]) player.x -= 0.1;
    if(keys["ArrowRight"]) player.x += 0.1;
    if(keys["ArrowUp"]) player.y -= 0.1;
    if(keys["ArrowDown"]) player.y += 0.1;

    // очистка экрана
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // рисуем карту
    for(let y=0;y<MAP_HEIGHT;y++){
        for(let x=0;x<MAP_WIDTH;x++){
            if(map[y][x] === 1){
                ctx.fillStyle = "#654321"; // земля
                ctx.fillRect(x*TILE_SIZE, y*TILE_SIZE, TILE_SIZE, TILE_SIZE);
            }
        }
    }

    // рисуем игрока
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x*TILE_SIZE, player.y*TILE_SIZE, TILE_SIZE, TILE_SIZE);

    requestAnimationFrame(gameLoop);
}
gameLoop();
</script>

</body>
</html>
